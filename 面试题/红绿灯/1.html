<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        class TrafficLight{
            constructor(){
                this.color = ['红灯','黄灯','绿灯']
                this.times = [3000,1000,2000]
                this.currentIndex = 0
                this.isRunning = false
            }
            setLightTime(color,time){
                const index = this.color.indexOf(color)
                if(index != -1){
                    this.times[index] = time
                }
            }
            setLightColor(color){
                const index = this.color.indexOf(color)
                if(index != -1){
                    this.currentIndex = index
                }
            }
            start(){
                this.isRunning = true
                this.changeLight();
            }
            pause(){
                this.isRunning = false
            }
            async changeLight(){
                 while(this.isRunning)
                 {
                    const color = this.colors[this.currentIndex]
                    const time = this.times[this.currentIndex]
                    console.log(`现在是：${color}`);
                    // promise 的高级应用
                    await new Promise((resolve)=>{
                        setTimeout(()=>{
                            resolve()
                        },time)
                    });
                    this.currentIndex = (this.currentIndex + 1)%this.colors.length
                 }
                
            }

        }
    </script>
</body>
</html>